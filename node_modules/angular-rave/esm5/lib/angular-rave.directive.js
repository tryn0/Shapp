/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Directive, Input, Output, HostListener, EventEmitter } from '@angular/core';
import { AngularRaveService } from './angular-rave.service';
/**
 * @record
 */
function MyWindow() { }
if (false) {
    /** @type {?} */
    MyWindow.prototype.getpaidSetup;
}
var AngularRaveDirective = /** @class */ (function () {
    function AngularRaveDirective(raveService) {
        this.raveService = raveService;
        this.raveOptions = {};
        this.onclose = new EventEmitter();
        this.callback = new EventEmitter();
        this.init = new EventEmitter();
        this._raveOptions = {};
    }
    /**
     * @return {?}
     */
    AngularRaveDirective.prototype.buttonClick = /**
     * @return {?}
     */
    function () {
        this.pay();
    };
    /**
     * @return {?}
     */
    AngularRaveDirective.prototype.pay = /**
     * @return {?}
     */
    function () {
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            var errorExists;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        errorExists = false;
                        if (this.raveOptions && Object.keys(this.raveOptions).length > 1) {
                            errorExists = this.checkInvalidOptions(this.raveOptions);
                            this.insertRaveOptions(this.raveOptions);
                        }
                        else {
                            errorExists = this.checkInvalidOptions(this);
                            this.insertRaveOptions(this);
                        }
                        if (errorExists) {
                            return [2 /*return*/];
                        }
                        return [4 /*yield*/, this.raveService.loadScript()];
                    case 1:
                        _a.sent();
                        this.paymentSetup = window.getpaidSetup(this._raveOptions);
                        if (this.init.observers.length > 0) {
                            this.init.emit(this.paymentSetup);
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    /**
     * @param {?} object
     * @return {?}
     */
    AngularRaveDirective.prototype.checkInvalidOptions = /**
     * @param {?} object
     * @return {?}
     */
    function (object) {
        /** @type {?} */
        var optionsInvalid = this.raveService.isInvalidOptions(object);
        if (optionsInvalid) {
            console.error(optionsInvalid);
        }
        return optionsInvalid !== '';
    };
    /**
     * @param {?} object
     * @return {?}
     */
    AngularRaveDirective.prototype.insertRaveOptions = /**
     * @param {?} object
     * @return {?}
     */
    function (object) {
        var _this = this;
        this._raveOptions = this.raveService.createRaveOptionsObject(object);
        if (this.onclose) {
            this._raveOptions.onclose = (/**
             * @return {?}
             */
            function () { return _this.onclose.emit(); });
        }
        this._raveOptions.callback = (/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            _this.onclose.emit(res);
            if (_this.autoClose) {
                _this.paymentSetup.close();
            }
        });
    };
    AngularRaveDirective.decorators = [
        { type: Directive, args: [{
                    selector: '[angular-rave]',
                },] }
    ];
    /** @nocollapse */
    AngularRaveDirective.ctorParameters = function () { return [
        { type: AngularRaveService }
    ]; };
    AngularRaveDirective.propDecorators = {
        amount: [{ type: Input }],
        autoClose: [{ type: Input }],
        country: [{ type: Input }],
        currency: [{ type: Input }],
        custom_description: [{ type: Input }],
        custom_logo: [{ type: Input }],
        custom_title: [{ type: Input }],
        customer_email: [{ type: Input }],
        customer_firstname: [{ type: Input }],
        customer_lastname: [{ type: Input }],
        customer_phone: [{ type: Input }],
        integrity_hash: [{ type: Input }],
        meta: [{ type: Input }],
        pay_button_text: [{ type: Input }],
        payment_method: [{ type: Input }],
        PBFPubKey: [{ type: Input }],
        raveOptions: [{ type: Input }],
        redirect_url: [{ type: Input }],
        subaccount: [{ type: Input }],
        txref: [{ type: Input }],
        onclose: [{ type: Output }],
        callback: [{ type: Output }],
        init: [{ type: Output }],
        buttonClick: [{ type: HostListener, args: ['click',] }]
    };
    return AngularRaveDirective;
}());
export { AngularRaveDirective };
if (false) {
    /** @type {?} */
    AngularRaveDirective.prototype.amount;
    /** @type {?} */
    AngularRaveDirective.prototype.autoClose;
    /** @type {?} */
    AngularRaveDirective.prototype.country;
    /** @type {?} */
    AngularRaveDirective.prototype.currency;
    /** @type {?} */
    AngularRaveDirective.prototype.custom_description;
    /** @type {?} */
    AngularRaveDirective.prototype.custom_logo;
    /** @type {?} */
    AngularRaveDirective.prototype.custom_title;
    /** @type {?} */
    AngularRaveDirective.prototype.customer_email;
    /** @type {?} */
    AngularRaveDirective.prototype.customer_firstname;
    /** @type {?} */
    AngularRaveDirective.prototype.customer_lastname;
    /** @type {?} */
    AngularRaveDirective.prototype.customer_phone;
    /** @type {?} */
    AngularRaveDirective.prototype.integrity_hash;
    /** @type {?} */
    AngularRaveDirective.prototype.meta;
    /** @type {?} */
    AngularRaveDirective.prototype.pay_button_text;
    /** @type {?} */
    AngularRaveDirective.prototype.payment_method;
    /** @type {?} */
    AngularRaveDirective.prototype.PBFPubKey;
    /** @type {?} */
    AngularRaveDirective.prototype.raveOptions;
    /** @type {?} */
    AngularRaveDirective.prototype.redirect_url;
    /** @type {?} */
    AngularRaveDirective.prototype.subaccount;
    /** @type {?} */
    AngularRaveDirective.prototype.txref;
    /** @type {?} */
    AngularRaveDirective.prototype.onclose;
    /** @type {?} */
    AngularRaveDirective.prototype.callback;
    /** @type {?} */
    AngularRaveDirective.prototype.init;
    /**
     * @type {?}
     * @private
     */
    AngularRaveDirective.prototype._raveOptions;
    /**
     * @type {?}
     * @private
     */
    AngularRaveDirective.prototype.paymentSetup;
    /**
     * @type {?}
     * @private
     */
    AngularRaveDirective.prototype.raveService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW5ndWxhci1yYXZlLmRpcmVjdGl2ZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL2FuZ3VsYXItcmF2ZS8iLCJzb3VyY2VzIjpbImxpYi9hbmd1bGFyLXJhdmUuZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxZQUFZLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFHckYsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sd0JBQXdCLENBQUM7Ozs7QUFFNUQsdUJBRUM7OztJQURDLGdDQUF5RTs7QUFLM0U7SUE4QkUsOEJBQW9CLFdBQStCO1FBQS9CLGdCQUFXLEdBQVgsV0FBVyxDQUFvQjtRQVYxQyxnQkFBVyxHQUFnQyxFQUFFLENBQUM7UUFJN0MsWUFBTyxHQUF1QixJQUFJLFlBQVksRUFBUSxDQUFDO1FBQ3ZELGFBQVEsR0FBc0IsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUN0RCxTQUFJLEdBQXlCLElBQUksWUFBWSxFQUFVLENBQUM7UUFDMUQsaUJBQVksR0FBZ0MsRUFBRSxDQUFDO0lBR0EsQ0FBQzs7OztJQUd4RCwwQ0FBVzs7O0lBRFg7UUFFRSxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7SUFDYixDQUFDOzs7O0lBRUssa0NBQUc7OztJQUFUOzs7Ozs7d0JBQ00sV0FBVyxHQUFHLEtBQUs7d0JBQ3ZCLElBQUksSUFBSSxDQUFDLFdBQVcsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFOzRCQUNoRSxXQUFXLEdBQUcsSUFBSSxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQzs0QkFDekQsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQzt5QkFDMUM7NkJBQU07NEJBQ0wsV0FBVyxHQUFHLElBQUksQ0FB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dkQsNENBQW1DOzs7OztJQUV2QiwyQ0FBdUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEaXJlY3RpdmUsIElucHV0LCBPdXRwdXQsIEhvc3RMaXN0ZW5lciwgRXZlbnRFbWl0dGVyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IFByaXZhdGVSYXZlT3B0aW9ucywgUGF5bWVudFNldHVwLCBSYXZlT3B0aW9ucyB9IGZyb20gJy4vcmF2ZS1vcHRpb25zJztcbmltcG9ydCB7IEFuZ3VsYXJSYXZlU2VydmljZSB9IGZyb20gJy4vYW5ndWxhci1yYXZlLnNlcnZpY2UnO1xuXG5pbnRlcmZhY2UgTXlXaW5kb3cgZXh0ZW5kcyBXaW5kb3cge1xuICBnZXRwYWlkU2V0dXA6IChyYXZlT3B0aW9uczogUGFydGlhbDxQcml2YXRlUmF2ZU9wdGlvbnM+KSA9PiBQYXltZW50U2V0dXA7XG59XG5cbmRlY2xhcmUgdmFyIHdpbmRvdzogTXlXaW5kb3c7XG5cbkBEaXJlY3RpdmUoe1xuICBzZWxlY3RvcjogJ1thbmd1bGFyLXJhdmVdJywgLy8gdHNsaW50OmRpc2FibGUtbGluZVxufSlcbmV4cG9ydCBjbGFzcyBBbmd1bGFyUmF2ZURpcmVjdGl2ZSB7XG4gIEBJbnB1dCgpIGFtb3VudDogbnVtYmVyO1xuICBASW5wdXQoKSBhdXRvQ2xvc2U6IGJvb2xlYW47XG4gIEBJbnB1dCgpIGNvdW50cnk6IHN0cmluZztcbiAgQElucHV0KCkgY3VycmVuY3k6IHN0cmluZztcbiAgQElucHV0KCkgY3VzdG9tX2Rlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIEBJbnB1dCgpIGN1c3RvbV9sb2dvOiBzdHJpbmc7XG4gIEBJbnB1dCgpIGN1c3RvbV90aXRsZTogc3RyaW5nO1xuICBASW5wdXQoKSBjdXN0b21lcl9lbWFpbDogc3RyaW5nO1xuICBASW5wdXQoKSBjdXN0b21lcl9maXJzdG5hbWU6IHN0cmluZztcbiAgQElucHV0KCkgY3VzdG9tZXJfbGFzdG5hbWU6IHN0cmluZztcbiAgQElucHV0KCkgY3VzdG9tZXJfcGhvbmU6IHN0cmluZztcbiAgQElucHV0KCkgaW50ZWdyaXR5X2hhc2g6IHN0cmluZztcbiAgQElucHV0KCkgbWV0YTogYW55O1xuICBASW5wdXQoKSBwYXlfYnV0dG9uX3RleHQ6IHN0cmluZztcbiAgQElucHV0KCkgcGF5bWVudF9tZXRob2Q6IHN0cmluZztcbiAgQElucHV0KCkgUEJGUHViS2V5OiBzdHJpbmc7XG4gIEBJbnB1dCgpIHJhdmVPcHRpb25zOiBQYXJ0aWFsPFByaXZhdGVSYXZlT3B0aW9ucz4gPSB7fTtcbiAgQElucHV0KCkgcmVkaXJlY3RfdXJsOiBzdHJpbmc7XG4gIEBJbnB1dCgpIHN1YmFjY291bnQ6IHsgaWQ6IHN0cmluZywgdHJhbnNhY3Rpb25fc3BsaXRfcmF0aW86IHN0cmluZyB9W107XG4gIEBJbnB1dCgpIHR4cmVmOiBzdHJpbmc7XG4gIEBPdXRwdXQoKSBvbmNsb3NlOiBFdmVudEVtaXR0ZXI8dm9pZD4gPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XG4gIEBPdXRwdXQoKSBjYWxsYmFjazogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcbiAgQE91dHB1dCgpIGluaXQ6IEV2ZW50RW1pdHRlcjxvYmplY3Q+ID0gbmV3IEV2ZW50RW1pdHRlcjxvYmplY3Q+KCk7XG4gIHByaXZhdGUgX3JhdmVPcHRpb25zOiBQYXJ0aWFsPFByaXZhdGVSYXZlT3B0aW9ucz4gPSB7fTtcbiAgcHJpdmF0ZSBwYXltZW50U2V0dXA6IFBheW1lbnRTZXR1cDtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJhdmVTZXJ2aWNlOiBBbmd1bGFyUmF2ZVNlcnZpY2UpIHsgfVxuXG4gIEBIb3N0TGlzdGVuZXIoJ2NsaWNrJylcbiAgYnV0dG9uQ2xpY2soKSB7XG4gICAgdGhpcy5wYXkoKTtcbiAgfVxuXG4gIGFzeW5jIHBheSgpIHtcbiAgICBsZXQgZXJyb3JFeGlzdHMgPSBmYWxzZTtcbiAgICBpZiAodGhpcy5yYXZlT3B0aW9ucyAmJiBPYmplY3Qua2V5cyh0aGlzLnJhdmVPcHRpb25zKS5sZW5ndGggPiAxKSB7XG4gICAgICBlcnJvckV4aXN0cyA9IHRoaXMuY2hlY2tJbnZhbGlkT3B0aW9ucyh0aGlzLnJhdmVPcHRpb25zKTtcbiAgICAgIHRoaXMuaW5zZXJ0UmF2ZU9wdGlvbnModGhpcy5yYXZlT3B0aW9ucyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVycm9yRXhpc3RzID0gdGhpcy5jaGVja0ludmFsaWRPcHRpb25zKHRoaXMpO1xuICAgICAgdGhpcy5pbnNlcnRSYXZlT3B0aW9ucyh0aGlzKTtcbiAgICB9XG4gICAgaWYgKGVycm9yRXhpc3RzKSB7IHJldHVybjsgfVxuICAgIGF3YWl0IHRoaXMucmF2ZVNlcnZpY2UubG9hZFNjcmlwdCgpO1xuICAgIHRoaXMucGF5bWVudFNldHVwID0gd2luZG93LmdldHBhaWRTZXR1cCh0aGlzLl9yYXZlT3B0aW9ucyk7XG4gICAgaWYgKHRoaXMuaW5pdC5vYnNlcnZlcnMubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5pbml0LmVtaXQodGhpcy5wYXltZW50U2V0dXApO1xuICAgIH1cbiAgfVxuXG4gIGNoZWNrSW52YWxpZE9wdGlvbnMob2JqZWN0OiBQYXJ0aWFsPFJhdmVPcHRpb25zPik6IGJvb2xlYW4ge1xuICAgIGNvbnN0IG9wdGlvbnNJbnZhbGlkID0gdGhpcy5yYXZlU2VydmljZS5pc0ludmFsaWRPcHRpb25zKG9iamVjdCk7XG4gICAgaWYgKG9wdGlvbnNJbnZhbGlkKSB7XG4gICAgICBjb25zb2xlLmVycm9yKG9wdGlvbnNJbnZhbGlkKTtcbiAgICB9XG4gICAgcmV0dXJuIG9wdGlvbnNJbnZhbGlkICE9PSAnJztcbiAgfVxuXG4gIGluc2VydFJhdmVPcHRpb25zKG9iamVjdDogUGFydGlhbDxSYXZlT3B0aW9ucz4pIHtcbiAgICB0aGlzLl9yYXZlT3B0aW9ucyA9IHRoaXMucmF2ZVNlcnZpY2UuY3JlYXRlUmF2ZU9wdGlvbnNPYmplY3Qob2JqZWN0KTtcbiAgICBpZiAodGhpcy5vbmNsb3NlKSB7IHRoaXMuX3JhdmVPcHRpb25zLm9uY2xvc2UgPSAoKSA9PiB0aGlzLm9uY2xvc2UuZW1pdCgpOyB9XG4gICAgdGhpcy5fcmF2ZU9wdGlvbnMuY2FsbGJhY2sgPSAocmVzKSA9PiB7XG4gICAgICB0aGlzLm9uY2xvc2UuZW1pdChyZXMpO1xuICAgICAgaWYgKHRoaXMuYXV0b0Nsb3NlKSB7XG4gICAgICAgIHRoaXMucGF5bWVudFNldHVwLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG59XG4iXX0=